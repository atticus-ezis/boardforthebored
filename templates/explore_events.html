{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="position-relative pt-5">

    <div class="d-flex flex-column justify-content-center align-items-center">

        <!-- search city -->
        <div class="card w-100 rounded shadow-lg" style="max-width: 700px;">

            <h1 class="card-title text-center mt-3">Explore Events</h1>

            <form method="POST" class="card-body d-flex p-4 justify-content-between" >
                {% csrf_token %}
                {{ form.city }} <!-- add .city to remove conflicting markup -->
                <button class="btn btn-primary" type="submit">Search</button>
            </form>

        </div>

        <br>

        <!-- results -->

        <!-- define key + values from tuple -->
        {% for class, event_lists in grouped_events.items %}

            <div class="mt-3 mb-3" style="max-width: 700px; overflow: hidden;">

                <!-- Events subject title -->
                <h1>{{class|title}}</h1>

                <!-- carousel wrapper -->
                <div id="eventCarousel" class="carousel slide" data-bs-ride="carousel">

                    <!-- carousel content-->
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <div class="d-flex justify-content-start" style="gap:20px; overflow-x: hidden;">

                                <!-- cards -->
                                {% for event in event_lists %} 
                                    <!-- event card -->
                                    <div class="card shadow-lg" style="width: 400px; height: auto; flex-shrink: 0;">
                                        
                                        <img class="card-img-top"src="{{ event.image_url }}" alt="{{ event.name }} image" style="width: 400px; height: 400px;">

                                        <div class="card-body" >
                                            <h3 class="card-title">{{ event.name }}</h3>
                                        
                                            <div class="card-body" style="width: 400px;">
                                                <p class="card-text">Date:
                                                    {% for date in event.dates %}
                                                        {{ date }}{% if not forloop.last %}, {% endif %}
                                                    {% endfor %}
                                                </p> 
                                                <p>ID:{{ event.id }}</p>
                                                <p class="card-text">Type:{{ event.class }}</p>
                                                <p class="card-text">Venue: {{ event.venue }}</p>
                                                <p class="card-text">City: {{ event.venue_city }}</p>
                                                <a class="btn btn-primary" href="{{ event.info }}" target="_blank">More Info / Buy Tickets</a>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                {% endfor %}                 
                      

                            </div>

                        </div>

                    </div>

                    <!-- carousel controls-->
                     <button class="carousel-control-prev" type="button" data-bs-target="#eventCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                     </button>
                     <button class="carousel-control-next" type="button" data-bs-target="#eventCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                     </button>

                </div>

            </div>

        {% endfor %}
                
       
        
    </div>
</div>



{% endblock content %}